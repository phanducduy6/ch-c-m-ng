<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C·ªïng Thanh To√°n ƒêa NƒÉng</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
        }
        .card {
            background: white;
            padding: 20px;
            border-radius: 24px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        h2 { color: #333; margin: 0 0 15px 0; font-size: 22px; }

        /* KHU V·ª∞C CH·ªåN NG√ÇN H√ÄNG (3 C·ªîNG) */
        .bank-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: #f5f5f5;
            padding: 5px;
            border-radius: 12px;
        }
        .tab-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            font-size: 13px;
        }
        .tab-btn.active {
            background: white;
            color: #000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        /* M√†u ri√™ng cho t·ª´ng tab khi active */
        .tab-btn.active[data-bank="VCB"] { color: #00C220; border: 1px solid #00C220; }
        .tab-btn.active[data-bank="MB"] { color: #120c6e; border: 1px solid #120c6e; }
        .tab-btn.active[data-bank="MOMO"] { color: #d82d8b; border: 1px solid #d82d8b; }

        /* Th√¥ng tin t√†i kho·∫£n */
        .bank-info {
            background: #eefbf3;
            border: 1px dashed #ccc;
            padding: 15px;
            border-radius: 16px;
            margin-bottom: 20px;
            text-align: left;
            font-size: 14px;
        }
        .bank-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .bank-val { font-weight: bold; color: #333; }

        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 24px;
            text-align: center;
            font-weight: bold;
            color: #333;
            outline: none;
            box-sizing: border-box;
            background: #f9fafb;
            margin-bottom: 15px;
        }
        input:focus { background: white; border-color: #333; }

        #qr_img {
            width: 100%;
            border-radius: 12px;
            border: 1px solid #eee;
            margin-bottom: 15px;
            display: block;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            text-decoration: none;
            margin-bottom: 10px;
            box-sizing: border-box;
            color: white;
            transition: 0.2s;
        }
        .btn-open { background-color: #00C220; }
        .btn-save { background-color: #4b5563; }
        
    </style>
</head>
<body>

    <div class="card">
        <h2>Thanh To√°n Online</h2>
        
        <div class="bank-tabs">
            <button class="tab-btn active" data-bank="VCB" onclick="switchBank('VCB')">Vietcombank</button>
            <button class="tab-btn" data-bank="MB" onclick="switchBank('MB')">MB Bank</button>
            <button class="tab-btn" data-bank="MOMO" onclick="switchBank('MOMO')">MoMo</button>
        </div>

        <div class="bank-info" id="bankInfoBox">
            <div class="bank-row"><span>Ng√¢n h√†ng:</span> <span class="bank-val" id="lbl_bank">Vietcombank</span></div>
            <div class="bank-row"><span>Ch·ªß TK:</span> <span class="bank-val" id="lbl_name">PHAN DUC DUY</span></div>
            <div class="bank-row"><span>S·ªë TK:</span> <span class="bank-val" id="lbl_acc">1041249904</span></div>
        </div>

        <input type="tel" id="amount" placeholder="Nh·∫≠p s·ªë ti·ªÅn..." onkeyup="formatMoney(this)">

        <img id="qr_img" src="" alt="QR Code"/>

        <button class="btn btn-save" onclick="downloadQR()">
            ‚¨á T·∫£i ·∫¢nh QR
        </button>
        
        <a href="#" id="deepLinkBtn" class="btn btn-open">
            üöÄ M·ªü App Ng√¢n H√†ng
        </a>
    </div>

    <script>
        // --- 1. C·∫§U H√åNH 3 T√ÄI KHO·∫¢N C·ª¶A B·∫†N ·ªû ƒê√ÇY ---
        const BANKS = {
            "VCB": {
                id: "VCB",
                name: "Vietcombank",
                acc: "1041249904",          // S·ªë TK Vietcombank c·ªßa b·∫°n
                user: "PHAN DUC DUY",
                color: "#eefbf3",           // M√†u n·ªÅn xanh l√° nh·∫°t
                border: "#00C220",
                appLink: "vcbdigibank://qr" // Link m·ªü app VCB
            },
            "MB": {
                id: "MB",
                name: "MB Bank",
                acc: "0987654321",          // <--- S·ª¨A S·ªê MB C·ª¶A B·∫†N ·ªû ƒê√ÇY
                user: "PHAN DUC DUY",
                color: "#eff1fc",           // M√†u n·ªÅn xanh d∆∞∆°ng nh·∫°t
                border: "#120c6e",
                appLink: "mbmobile://"      // Link m·ªü app MB
            },
            "MOMO": {
                id: "MOMO",
                name: "V√≠ MoMo",
                acc: "0912345678",          // <--- S·ª¨A S·ªê ƒêI·ªÜN THO·∫†I MOMO ·ªû ƒê√ÇY
                user: "PHAN DUC DUY",
                color: "#fceef5",           // M√†u n·ªÅn h·ªìng nh·∫°t
                border: "#d82d8b",
                appLink: "momo://"          // Link m·ªü app MoMo
            }
        };

        // Bi·∫øn l∆∞u ng√¢n h√†ng ƒëang ch·ªçn (M·∫∑c ƒë·ªãnh l√† VCB)
        let currentBank = "VCB"; 

        // H√†m ch·∫°y khi ƒë·ªïi tab
        function switchBank(bankCode) {
            currentBank = bankCode;
            
            // 1. ƒê·ªïi giao di·ªán n√∫t tab
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if(btn.dataset.bank === bankCode) btn.classList.add('active');
            });

            // 2. C·∫≠p nh·∫≠t th√¥ng tin ch·ªØ
            const data = BANKS[bankCode];
            document.getElementById("lbl_bank").innerText = data.name;
            document.getElementById("lbl_name").innerText = data.user;
            document.getElementById("lbl_acc").innerText = data.acc;

            // 3. ƒê·ªïi m√†u s·∫Øc cho ƒë·∫πp
            const infoBox = document.getElementById("bankInfoBox");
            infoBox.style.backgroundColor = data.color;
            infoBox.style.borderColor = data.border;
            document.getElementById("deepLinkBtn").style.backgroundColor = data.border;

            // 4. C·∫≠p nh·∫≠t n√∫t m·ªü App
            document.getElementById("deepLinkBtn").href = data.appLink;

            // 5. C·∫≠p nh·∫≠t l·∫°i QR
            const amountInput = document.getElementById("amount");
            // L·∫•y s·ªë ti·ªÅn ƒëang nh·∫≠p (ƒë√£ x√≥a d·∫•u ph·∫©y)
            const rawAmount = amountInput.value.replace(/\D/g, ""); 
            updateQR(rawAmount);
        }

        // Kh·ªüi ch·∫°y l·∫ßn ƒë·∫ßu
        switchBank('VCB');

        function formatMoney(input) {
            let val = input.value.replace(/\D/g, "");
            input.value = val ? parseInt(val).toLocaleString('en-US') : "";
            updateQR(val);
        }

        function updateQR(amount) {
            const data = BANKS[currentBank];
            let url;
            
            if(amount > 0) {
                // QR ƒê·ªông (c√≥ ti·ªÅn)
                url = `https://img.vietqr.io/image/${data.id}-${data.acc}-compact2.png?amount=${amount}&addInfo=THANH TOAN&accountName=${data.user}`;
            } else {
                // QR Tƒ©nh (ch∆∞a nh·∫≠p ti·ªÅn)
                url = `https://img.vietqr.io/image/${data.id}-${data.acc}-compact2.png`;
            }
            document.getElementById("qr_img").src = url;
        }

        async function downloadQR() {
            const btn = document.querySelector(".btn-save");
            btn.innerText = "‚è≥ ƒêang t·∫£i...";
            try {
                const img = document.getElementById("qr_img");
                const blob = await (await fetch(img.src)).blob();
                const a = document.createElement("a");
                a.href = URL.createObjectURL(blob);
                a.download = `QR_${currentBank}_${BANKS[currentBank].acc}.png`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                btn.innerText = "‚úÖ ƒê√£ l∆∞u!";
            } catch (e) {
                alert("L·ªói t·∫£i ·∫£nh. H√£y ch·ª•p m√†n h√¨nh nh√©!");
            }
            setTimeout(() => btn.innerText = "‚¨á T·∫£i ·∫¢nh QR", 2000);
        }
    </script>

</body>
</html>
